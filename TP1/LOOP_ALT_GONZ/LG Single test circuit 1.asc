Version 4
SHEET 1 1432 940
WIRE 96 128 80 128
WIRE 112 128 96 128
WIRE 112 160 112 128
WIRE 320 240 256 240
WIRE 400 240 320 240
WIRE 256 288 256 240
WIRE 112 336 112 240
WIRE 144 336 112 336
WIRE 112 368 112 336
WIRE 112 368 -32 368
WIRE 592 384 576 384
WIRE 608 384 592 384
WIRE 112 400 112 368
WIRE 400 400 400 240
WIRE 576 416 576 384
WIRE 256 448 256 384
WIRE 256 448 176 448
WIRE 336 448 256 448
WIRE -32 464 -32 368
WIRE -32 560 -32 528
WIRE 112 560 112 496
WIRE 112 560 -32 560
WIRE 256 560 112 560
WIRE 400 560 400 496
WIRE 400 560 256 560
WIRE 576 560 576 496
WIRE 256 592 256 560
FLAG 320 240 VCC
FLAG 96 128 VCC
FLAG 256 592 0
FLAG 576 560 0
FLAG 592 384 VCC
FLAG 112 336 VI
SYMBOL current 112 160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I1
SYMATTR Value 1m
SYMBOL npn 176 400 M0
SYMATTR InstName Q1
SYMATTR Value 2N3904
SYMBOL npn 336 400 R0
SYMATTR InstName Q2
SYMATTR Value 2N3904
SYMBOL npn 192 288 R0
SYMATTR InstName Q3
SYMATTR Value 2N3904
SYMBOL voltage 576 400 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 5
SYMBOL cap -48 464 R0
SYMATTR InstName C1
SYMATTR Value 100p
SYMBOL MySymbols\\LG_single 176 336 R0
SYMATTR InstName LGS
TEXT -32 56 Left 3 ;LG SINGLE TEST CIRCUIT - Current Mirror
TEXT -32 664 Left 2 !;op
TEXT -32 704 Left 2 !.param lg = 0 ; zero value turns off probe\n  .step param lg list -1 1
TEXT -32 776 Left 2 !.ac dec 100 1 10G
TEXT -32 816 Left 2 !.meas AC phase_margin FIND -1/(1-1/(2*(I(LGS:Vi)@1*V(LGS:x)@2-V(LGS:x)@1*I(LGS:Vi)@2)+V(LGS:x)@1+I(LGS:Vi)@2))\n   + WHEN mag(-1/(1-1/(2*(I(LGS:Vi)@1*V(LGS:x)@2-V(LGS:x)@1*I(LGS:Vi)@2)+V(LGS:x)@1+I(LGS:Vi)@2)))=1
TEXT -24 896 Left 2 !.meas AC gain_margin FIND -1/(1-1/(2*(I(LGS:Vi)@1*V(LGS:x)@2-V(LGS:x)@1*I(LGS:Vi)@2)+V(LGS:x)@1+I(LGS:Vi)@2))\n   + WHEN ph(-1/(1-1/(2*(I(LGS:Vi)@1*V(LGS:x)@2-V(LGS:x)@1*I(LGS:Vi)@2)+V(LGS:x)@1+I(LGS:Vi)@2)))=0
